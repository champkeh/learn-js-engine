# learn-js-engine
记录自己学习JavaScript引擎的一些总结

> 主要是关于v8的内容，后续可能会涉及到v8和其他引擎之间的对比

## 配置v8的调试工具d8
这里，由于国内不可描述的原因，从下载源码自己编译出一个`d8`比较困难，所以直接使用已经编译好的`d8`工具。

### 1. 获取当前最新的v8版本
```
https://storage.googleapis.com/chromium-v8/official/canary/v8-mac64-dbg-latest.json
==>
{"version": "8.4.144"}
```


### 2. 下载对应平台的`d8`
```
mac平台:
https://storage.googleapis.com/chromium-v8/official/canary/v8-mac64-dbg-${version}.zip

linux32平台:
https://storage.googleapis.com/chromium-v8/official/canary/v8-linux32-dbg-${version}.zip

linux64平台:
https://storage.googleapis.com/chromium-v8/official/canary/v8-linux64-dbg-${version}.zip

win32平台:
https://storage.googleapis.com/chromium-v8/official/canary/v8-win32-dbg-${version}.zip

win64平台:
https://storage.googleapis.com/chromium-v8/official/canary/v8-win64-dbg-${version}.zip
```

比如，我要下载`mac`平台的`d8`，直接浏览器访问`https://storage.googleapis.com/chromium-v8/official/canary/v8-mac64-dbg-8.4.144.zip`，
就可以下载到`v8.4.144`这个版本的`d8`了。
> storage.googleapis.com 这个域名在国内是可以直接访问的。

### 3. 使用d8输出一些信息
> 我已经下载好了一个v8.4.144的工具，放在了v8-dbg下面，里面有一个可行性文件d8。

```shell script
$ ./v8-dbg/d8 demo.js --print-bytecode
...
[generated bytecode for function: foo (0x2ada0824fe61 <SharedFunctionInfo foo>)]
Parameter count 3
Register count 0
Frame size 0
         0x2ada0825000e @    0 : 25 02             Ldar a1
         0x2ada08250010 @    2 : 34 03 00          Add a0, [0]
         0x2ada08250013 @    5 : aa                Return 
Constant pool (size = 0)
Handler Table (size = 0)
Source Position Table (size = 0)
```
可以看到我们的`foo`函数对应的字节码。

## 优质文章

1. [JavaScript engine fundamentals: Shapes and Inline Caches](https://mathiasbynens.be/notes/shapes-ics)
2. [JavaScript engine fundamentals: optimizing prototypes](https://mathiasbynens.be/notes/prototypes)
